<!doctype html>
<head>
<meta name="viewport"
	content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0">
<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>小米网订单风险控制系统</title>

<link
	href="assets/css/bootstrap.css"
	rel="stylesheet">
	<link rel="shortcut icon" href="/images/ico/favicon.ico">
<link
	href="assets/css/bootstrap-responsive.css"
	rel="stylesheet">
</head>
<script
	src="assets/js/jquery.js"></script>
<script
	src="assets/js/bootstrap-modal.js"></script>
<body>
	<!-- S 顶部导航 -->
	


<script type="text/javascript">
	var appContextPath = "";
</script>
<div class="sidebar-background"></div>
<div class="navbar navbar-top navbar-inverse">
	<div class="navbar-inner">
		<div class="container-fluid">
			<a class="brand" href="#">小米网订单风险控制系统</a>
			<ul class="nav">
				
					<li class="active"><a
						href="/site/index.do">
							
								<i class="icon-home"></i>
							首页
					</a></li>
				
					<li ><a
						href="/alarm/orderInfoExc.do">
							
								<i class="icon-desktop"></i>
							监控预警
					</a></li>
				
					<li ><a
						href="/report/orderStatic.jsp">
							
								<i class=""></i>
							数据统计分析
					</a></li>
				
					<li ><a
						href="/setting/lockSynSetting.do?type=2">
							
								<i class="icon-asterisk"></i>
							系统设置
					</a></li>
				
					<li ><a
						href="/user/list.do">
							
								<i class="icon-user"></i>
							用户及权限
					</a></li>
				
			</ul>
			<!-- the new toggle buttons -->
			<ul class="nav pull-right">
				<li class="toggle-sidebar hidden-desktop"><a><i
						class="icon-list-alt"></i></a></li>
				<li class="toggle-primary-sidebar hidden-desktop hidden-tablet"><a><i
						class="icon-th-list"></i></a></li>
				<li class="collapsed hidden-desktop" data-toggle="collapse"
					data-target=".nav-collapse"><a><i
						class="icon-align-justify"></i></a></li>
			</ul>
			<div class="nav-collapse">
				<ul class="nav full pull-right">
					<li class="dropdown user-avatar">
						<!-- the dropdown has a custom user-avatar class, this is the small avatar with the badge -->
						<a href="#" class="dropdown-toggle" data-toggle="dropdown"> <span>
								<img class="menu-avatar"
								src="">
								<span>汤学旭<i class="icon-caret-down"></i></span> <span
								class="badge badge-dark-red">5</span>
						</span>
					</a>
						<ul class="dropdown-menu">
							<!-- the first element is the one with the big avatar, add a with-image class to it -->
							<li class="with-image">
								<div class="avatar">
									<img
										src="">
								</div> <span>汤学旭</span>
							</li>
							<li class="divider"></li>
							<li><a href="#"><i class="icon-user"></i> <span>个人资料</span></a></li>
							<li><a href="#"><i class="icon-cog"></i> <span>账户设置</span></a></li>
							<li><a href="#"><i class="icon-envelope"></i> <span>消息</span>
									<span class="label label-dark-red pull-right">5</span></a></li>
							<li><a
								href="/site/logout.do"><i
									class="icon-off"></i> <span>退出</span></a></li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>

	<!-- E 顶部导航 -->

	<!-- S 侧边栏导航 -->
	

<div class="sidebar">
	<!-- S 侧边栏导航__副导航 -->
	<div class="secondary-sidebar">
		<div class="secondary-sidebar">
			<div class="area-top">
				<ul class="inline">
					<li>
						<div class="avatar">
							<img src="/images/mi-logo.jpg" />
						</div>
					</li>
					<li>Welcome
						<div class="title"></div>
					</li>
				</ul>
			</div>
			<div class="breadcrumb-line navbar"><ul class="breadcrumbs pull-left"><li>&nbsp;</li></ul></div>
			<ul class="nav nav-list bs-docs-sidenav">
				
					<li class="active" ><a
						href="/site/index.do">
						
						<i class=" icon-calendar"></i>
						
						<i class="icon-chevron-right"></i>监控首页</a></li>
				
			</ul>
			<div class="divider">
				<span></span>
			</div>

		</div>
	</div>
	<!-- E 侧边栏导航__副导航 -->
</div>


	<!-- E 侧边栏导航 -->

	<!-- S 主要内容区域 -->
	<div class="main-content">
		<!-- S 内容导航 -->
		





<script src="/js/common.js"></script>
<body>
<div class="container-fluid">
	<div class="row-fluid">
		<div class="area-top">
			<div class="pull-left header">
				<i class="icon-edit icon-2x"></i> <span class="title">数据概况</span>
			</div>
			<ul class="num-stats pull-right num-stats-more">
				<li class="stat-blue">
					<ul class="inline">
						<li class="hidden-phone glyph"><i class="icon-money"></i></li>
						<li><span class="number" id="navt">--</span> 预警总数</li>
					</ul>
					<div class="num-stats-more-box">
						<table class="table table-striped table-bordered table-condensed num-stats-more-table">
							<tbody>
								<tr>
									<td style="text-align: center;"><a href="/alarm/orderInfoExc.do">订单信息异常</a></td>
									<td class="status-error">234</td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/infoSyncExc.do">信息同步异常</a></td>
									<td class="status-error">22</td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/orderFlowExc.do">订单流转异常</a></td>
									<td class="status-error">134</td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/deliverFlowExc.do">发货单流转异常</a></td>
									<td class="status-error">423</td>
								</tr>

								<tr>
									<td style="text-align: center;">预警合计</td>
									<td class="status-error">67867</td>
								</tr>

								<tr>
									<td style="text-align: left;" colspan="2">注：信息异常预警均为严重级别预警</td>
								</tr>

							</tbody>
						</table>
					</div>
				</li>
				<li class="stat-danger">
					<ul class="inline">
						<li class="hidden-phone glyph"><i class="icon-ok-circle"></i></li>
						<li><span class="number" id="navs">--</span> 严重预警</li>
					</ul>
				</li>
				<li class="stat-warning">
					<ul class="inline">
						<li class="hidden-phone glyph"><i class="icon-plus"></i></li>
						<li><span class="number" id="navn">--</span> 一般预警</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<div class="row-fluid">
		<div class="breadcrumb-line navbar">
			<ul class="breadcrumbs pull-left">
				<li><a href="#"><i class="icon-home"></i>首页 </a></li>
				
					
					
						<li class="current"><i class="icon-edit"></i><a
							href="/site/index.do">
								监控首页 </a></li>
					
				
			</ul>
		</div>
	</div>
</div>
</body>
		<!-- E 内容导航 -->
		<div class="container-fluid hpadded">
			<div class="row-fluid">
				


<style type="text/css">
 .status-error a{color:#d13b3b;font-size:14px;text-decoration:none}
 </style>
<div class="row-fluid">
	<div class="bs-docs-grid">
		<div class="row-fluid">
			<div class="span6">
				<div class="box">
					<div class="box-header">
						<span class="title">异常报警</span>
					</div>
					<div class="box-content">
						<div id="hightcharts_pieA" style="overflow:hidden;"></div>

						<table class="table table-normal">
							<thead>
								<tr>
									<td></td>
									<td>预警数</td>
								</tr>
							</thead>

							<tbody>
								<tr>
									<td style="text-align: center;"><a href="/alarm/orderInfoExc.do">订单信息异常</a></td>
									<td class="status-error"><a href="/alarm/orderInfoExc.do"><span id=oie>--</span></a></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/infoSyncExc.do">信息同步异常</a></td>
									<td class="status-error"><a href="/alarm/infoSyncExc.do"><span id=ae>--</span></a></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/orderFlowExc.do">订单流转异常</a></td>
									<td class="status-error"><a href="/alarm/orderFlowExc.do"><span id=ofe>--</span></a></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/deliverFlowExc.do">发货单流转异常</a></td>
									<td class="status-error"><a href="/alarm/deliverFlowExc.do"><span id=dfe>--</span></a></td>
								</tr>

								<tr>
									<td style="text-align: center;">预警合计</td>
									<td class="status-error"><span id=te>--</span></td>
								</tr>

								<tr>
									<td style="text-align: left;" colspan="2">注：信息异常预警均为严重级别预警</td>
								</tr>

							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div class="span6">
				<div class="box">
					<div class="box-header">
						<span class="title">超时报警</span>
					</div>
					<div class="box-content">
						<div id="hightcharts_pieB" style="overflow:hidden;"></div>
						<table class="table table-normal">
							<thead>
								<tr>
									<td></td>
									<td>一般预警</td>
									<td>严重预警</td>
									<td>预警总数</td>
								</tr>
							</thead>

							<tbody>
								<tr>
									<td style="text-align: center;"><a href="/alarm/orderStatusOvertime.do">订单状态超时</a></td>
									<td class="status-warning" style="text-align: center;"><span id=c1>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=s1>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=t1>--</span></td>
								</tr>

								<tr>
									<td style="text-align: center;"></i><a href="/alarm/deliverStatusOvertime.do">发货单状态超时</a></td>
									<td class="status-warning" style="text-align: center;"><span id=c2>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=s2>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=t2>--</span></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/lockOvertime.do">锁定超时</a></td>
									<td class="status-warning" style="text-align: center;"><span id=c3>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=s3>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=t3>--</span></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/deliverOvertime.do">发货超时</a></td>
									<td class="status-warning" style="text-align: center;"><span id=c4>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=s4>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=t4>--</span></td>
								</tr>

								<tr>
									<td style="text-align: center;"><a href="/alarm/infoSyncOvertime.do">信息同步超时</a></td>
									<td class="status-warning" style="text-align: center;"><span id=c5>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=s5>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=t5>--</span></td>
								</tr>

								<tr>
									<td style="text-align: center;">预警合计</td>
									<td class="status-warning" style="text-align: center;"><span id=ct>--</span></td>
									<td class="status-error" style="text-align: center;"><span id=st>--</span></td>
									<td class="status-info" style="text-align: center;"><span id=tt>--</span></td>
								</tr>

							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

</div>









<!-- E 主要内容区域__TAB切换 -->
<!-- S 主要内容区域__绘图charts -->
<div class="container-fluid padded"
	style="width: 100%; margin: 0px 0px 0px 0px; padding: 0px 0px 0px;">
	<div class="box">
		<div class="box-header">
			<span class="title">综合图</span>
		</div>
		<div class="box-content padded">
			<div id="hightcharts_combin"></div>
		</div>
	</div>
</div>
<!-- E 主要内容区域__绘图charts -->

<!-- E 主要内容区域 -->

<script
		src="assets/js/highcharts.js"></script>
<script
		src="assets/js/exporting.js"></script>


<script type="text/javascript">
var orderCounter=[{"y":18,"x":1369638720000},{"y":20,"x":1369638780000},{"y":19,"x":1369638840000},{"y":17,"x":1369638900000},{"y":17,"x":1369638960000},{"y":24,"x":1369639020000},{"y":22,"x":1369639080000},{"y":22,"x":1369639140000},{"y":18,"x":1369639200000},{"y":21,"x":1369639260000},{"y":15,"x":1369639320000},{"y":19,"x":1369639380000},{"y":7,"x":1369639440000},{"y":15,"x":1369639500000},{"y":16,"x":1369639560000},{"y":10,"x":1369639620000},{"y":20,"x":1369639680000},{"y":28,"x":1369639740000},{"y":24,"x":1369639800000},{"y":18,"x":1369639860000},{"y":24,"x":1369639920000},{"y":15,"x":1369639980000},{"y":25,"x":1369640040000},{"y":20,"x":1369640100000},{"y":28,"x":1369640160000},{"y":17,"x":1369640220000},{"y":18,"x":1369640280000},{"y":20,"x":1369640340000},{"y":17,"x":1369640400000},{"y":17,"x":1369640460000}];
var payCounter=[{"y":11,"x":1369638720000},{"y":8,"x":1369638780000},{"y":6,"x":1369638840000},{"y":8,"x":1369638900000},{"y":8,"x":1369638960000},{"y":12,"x":1369639020000},{"y":10,"x":1369639080000},{"y":13,"x":1369639140000},{"y":10,"x":1369639200000},{"y":5,"x":1369639260000},{"y":12,"x":1369639320000},{"y":10,"x":1369639380000},{"y":4,"x":1369639440000},{"y":4,"x":1369639500000},{"y":7,"x":1369639560000},{"y":6,"x":1369639620000},{"y":12,"x":1369639680000},{"y":8,"x":1369639740000},{"y":10,"x":1369639800000},{"y":3,"x":1369639860000},{"y":16,"x":1369639920000},{"y":4,"x":1369639980000},{"y":10,"x":1369640040000},{"y":5,"x":1369640100000},{"y":9,"x":1369640160000},{"y":4,"x":1369640220000},{"y":4,"x":1369640280000},{"y":4,"x":1369640340000},{"y":4,"x":1369640400000}];
$(function() {

	$(".num-stats-more > li").mouseenter(function(){
		$(this).find(".num-stats-more-box").fadeIn();
	})
	$(".num-stats-more-box").mouseleave(function(){
		$(this).hide();
	})
	
	$(document).ready(
		function() {
			Highcharts.setOptions({
				global : {
					useUTC : false
				}
			});
			var chart;
			$('#hightcharts_combin').highcharts({
				chart : {
					type : 'spline',
					marginRight : 30,
					events : {
						load : function() {
							// set up the updating of the chart each second
							var orderSeries = this.series[0];
							var paySeries = this.series[1];
							setInterval(function() {
								$.getJSON(	"/ajax/orderAnalytics.do",
										function(data) {
											var y = parseInt(data[0]['orderCounter'][0].y);
											var y = parseInt(data[0]['payCounter'][0].y);
											orderSeries.addPoint([data[0]['orderCounter'][0].x,y],true,true);											
											paySeries.addPoint([data[0]['payCounter'][0].x,y],true,true);
										});
		
							},
							1000 * 60);
						}
					}
				},
				title : {
					text : '下单走势图'
				},
				xAxis : {
					type : 'datetime',
					tickPixelInterval : 150
				},
				yAxis : {
					title : {
						text : '新增单量'
					},
					plotLines : [ {
						value : 0,
						width : 1,
						color : '#808080'
					} ]
				},
				tooltip : {
					formatter : function() {
						return '<b>'
								+ this.series.name
								+ '</b><br/>时间：'
								+ Highcharts.dateFormat('%Y-%m-%d %H:%M',this.x)
								+ '<br/>数量：'
								+ Highcharts.numberFormat(this.y,0);
					}
				},
				legend : {
	                layout: 'vertical',
	                align: 'right',
	                verticalAlign: 'top',
	                x: -10,
	                y: 100,
	                borderWidth: 0
				},
				exporting : {
					enabled : false
				},
	            series: [{
	                name: '下单量',
	                data: (function() {

	                   var data=orderCounter;
	                    
	                    return data;
	                })()
	            },{
	                name: '支付量',
	                data: (function() {

	                   var data=payCounter;
	                    
	                    return data;
	                })()
	            }]
			});
		

		$.getJSON('/summary/exception.do', function(data_piea) {
			var data = eval(data_piea);
			for(var i = 0, l = data.length; i < l; i++) {				
			    data[i][0] = data[i][0].replace("orderInfoException","订单信息异常")
			    data[i][0] = data[i][0].replace("asyncException","信息同步异常")
			    data[i][0] = data[i][0].replace("orderFlowException_last","订单流转异常")
			    data[i][0] = data[i][0].replace("deliverFlowException_last","发货单流转异常")
			}
			$("#oie").html(data[0][1]);
			$("#ae").html(data[1][1]);
			$("#ofe").html(data[2][1]);
			$("#dfe").html(data[3][1]);
			$("#te").html(data[0][1]+data[1][1]+data[2][1]+data[3][1]);
			
			$('#hightcharts_pieA').highcharts({
	            chart: {
	                plotBackgroundColor: null,
	                plotBorderWidth: null,
	                plotShadow: false
	            },
	            title: {
	                text: '异常报警总览'
	            },
	            colors: ['#ED561B', '#DDDF00', '#24CBE5', '#64E572'],
	            tooltip: {
	        	    pointFormat: '{series.name}: <b>{point.percentage}%</b>',
	            	percentageDecimals: 2,
	            	formatter: function() {  
	                    return this.point.name + this.point.percentage.toFixed(2)+'%';
	            	}
	            },
	            plotOptions: {
	                pie: {
	                    allowPointSelect: true,
	                    cursor: 'pointer',
	                    dataLabels: {
	                        enabled: true,
	                        color: '#000000',
	                        connectorColor: '#000000',
	                        formatter: function() {
	                            return '<b>'+ this.point.name +'</b>: '+ this.percentage.toFixed(2) +' %';
	                        }
	                    }
	                }
	            },
	            series: [{
	                type: 'pie',
	                name: '占比',
	                data: data
	            }]
	        });
		});
		//
		$.getJSON('/summary/overtime.do', function(data_piea) {
		
		var data = eval(data_piea);
		var com = data[0].com;
		var ser = data[0].ser;
		var ct=0;var st=0;var tt=0;
		for(var i = 0, l = com.length; i < l; i++) {				
		    $("#c"+(i+1)).html(com[i]);
		    $("#s"+(i+1)).html(ser[i]);
		    $("#t"+(i+1)).html(com[i]+ser[i]);
		    ct += com[i];
		    st += ser[i];
		    tt += (com[i]+ser[i]);
		}				
	    $("#ct").html(ct);
	    $("#st").html(st);
	    $("#tt").html(tt);
		
		$('#hightcharts_pieB').highcharts({
            chart: {
                type: 'area'
            },
            title: {
                text: '超时报警'
            },
/*             subtitle: {
                text: '超时报警'
            }, */
            colors: ['#e36d2d','#d13b3b'],
            xAxis: {
                categories:  ['订单状态超时','发货单状态超时','锁定超时', '发货超时', '信息同步超时']
            },
            yAxis: {
                title: {
                    text: '数量（单位：个）'
                },
                labels: {
                    formatter: function() {
                        return this.value +'个';
                    }
                }
            },
            tooltip: {
                pointFormat: '{series.name} 数量 <b>{point.y:,.0f}</b>'
            },
            plotOptions: {
                area: {
                    pointStart: 0,
                    marker: {
                        enabled: false,
                        symbol: 'circle',
                        radius: 2,
                        states: {
                            hover: {
                                enabled: true
                            }
                        }
                    }
                }
            },
            series:  [{
            	name: '一般预警',
                data: data[0].com
            }, {
            	name: '严重预警',
                data: data[0].ser
            }]
        });
        });
	});

});
function changeTwoDecimal(x){
	var f_x = parseFloat(x);
	if (isNaN(f_x)){
		alert('function:changeTwoDecimal->parameter error');
		return false;
	}
	var f_x = Math.round(x*100)/100;	
	return f_x;
}
</script>
			</div>
		</div>
	</div>
	<!-- E 主要内容区域 -->

	<!-- S 底部 -->
	
<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog"
	aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal"
			aria-hidden="true">×</button>
		<h3 id="myModalLabel">操作提示</h3>
	</div>
	<div class="modal-body">
		<p id="submit_info">提示信息</p>
	</div>
	<div class="modal-footer">
		<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
	</div>
</div>
<!-- end Modal -->

<!-- Le javascript
    ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/bootstrap-transition.js"></script>
<script src="assets/js/bootstrap-alert.js"></script>
<script src="assets/js/bootstrap-dropdown.js"></script>
<script src="assets/js/bootstrap-scrollspy.js"></script>
<script src="assets/js/bootstrap-tab.js"></script>
<script src="assets/js/bootstrap-tooltip.js"></script>
<script src="assets/js/bootstrap-popover.js"></script>
<script src="assets/js/bootstrap-button.js"></script>
<script src="assets/js/bootstrap-collapse.js"></script>
<script src="assets/js/bootstrap-carousel.js"></script>
<script src="assets/js/bootstrap-typeahead.js"></script>


<script src="assets/js/bootstrap-datepicker.js"></script>
<script src="assets/js/bootstrap-datepicker.zh-CN.js"></script>
<script src="assets/js/select2.js"></script>
<script src="assets/js/jquery.tagsinput.js"></script>
<script src="assets/js/jquery.easy-pie-chart.js"></script>
<script src="assets/js/raphael.2.1.0.min.js"></script>
<script src="assets/js/justgage.js"></script>
<script src="assets/js/jquery.sparkline.js"></script>
<script src="assets/js/jquery.dataTables.js"></script>
<script src="assets/js/touchTouch.jquery.js"></script>
<script src="assets/js/jquery.gritter.js"></script>
	<!-- E 底部 -->
</body>
</html>